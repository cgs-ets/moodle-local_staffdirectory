define(["jquery","core/log","core/ajax"],function(l,e,t){"use strict";function r(t){var e=this;e.rootel=t,e.dir=e.rootel.find(".directory-list").first()}return r.prototype.main=function(){var r,i=this;i.rootel.on("keyup",".directory-search",function(t){clearTimeout(r);var e=l(this);13==t.which?i.search(e):r=setTimeout(function(){i.search(e)},500)})},r.prototype.search=function(t){var e=this;if(e.hasresults=!1,""!=t.val()){var r=t.val();e.rootel.addClass("searching"),e.rootel.removeClass("noitems"),e.dir.find(".dir-row").hide();var i=e.dir.find(".attr_staffcode").filter(function(){return new RegExp(r,"i").test(l(this).text())}).parent(),o=e.dir.find(".attr_displayname").filter(function(){return new RegExp(r,"i").test(l(this).text())}).parent(),n=e.dir.find(".attr_campus").filter(function(){return new RegExp(r,"i").test(l(this).text())}).parent(),s=e.dir.find(".attr_department").filter(function(){return new RegExp(r,"i").test(l(this).text())}).parent(),a=e.dir.find(".attr_jobposition").filter(function(){return new RegExp(r,"i").test(l(this).text())}).closest(".dir-row");i.show(),o.show(),n.show(),s.show(),a.show(),e.rootel.removeClass("searching"),i.length+o.length+n.length+s.length+a.length||e.rootel.addClass("noitems")}else e.dir.find(".dir-row").show()},{init:function(){e.debug("local_staffdirectory/directory: initializing");var t=l("#local_staffdirectory-root");t.length?new r(t).main():e.error("local_staffdirectory/directory: '#local_staffdirectory-root' not found!")}}});